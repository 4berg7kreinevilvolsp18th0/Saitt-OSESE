# –û—Ç—á–µ—Ç –ø–æ –∞—É–¥–∏—Ç—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —Ö–∞–∫–µ—Ä–∞. –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é.

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. Rate Limiting –≤ –ø–∞–º—è—Ç–∏ (middleware.ts)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
const rateLimitMap = new Map<string, { count: number; resetTime: number }>();
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- Rate limiting —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å—á–µ—Ç—á–∏–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
- –í production —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏ –∫–∞–∂–¥—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –∏–º–µ–µ—Ç —Å–≤–æ–π —Å—á–µ—Ç—á–∏–∫
- –õ–µ–≥–∫–æ –æ–±–æ–π—Ç–∏, –º–µ–Ω—è—è IP –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π - –±—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫–∏ –º–æ–≥—É—Ç –æ–±–æ–π—Ç–∏ –∑–∞—â–∏—Ç—É

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ rate limiting
import { Redis } from '@upstash/redis';

const redis = new Redis({
  url: process.env.UPSTASH_REDIS_URL,
  token: process.env.UPSTASH_REDIS_TOKEN,
});

async function checkRateLimit(ip: string, path: string) {
  const key = `rate_limit:${ip}:${path}`;
  const count = await redis.incr(key);
  
  if (count === 1) {
    await redis.expire(key, 60); // 60 —Å–µ–∫—É–Ω–¥
  }
  
  return count <= maxRequests;
}
```

### 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤ localStorage (login/page.tsx)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
localStorage.setItem('login_blocked', blockTime.toISOString());
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –õ–µ–≥–∫–æ –æ–±–æ–π—Ç–∏: –æ—á–∏—Å—Ç–∏—Ç—å localStorage –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä
- –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∞—Ç–∞–∫

**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π - –∑–∞—â–∏—Ç–∞ –ª–µ–≥–∫–æ –æ–±—Ö–æ–¥–∏—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä (Redis/–ë–î)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP-based –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å rate limiting –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 3. –£—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ—à–∏–±–∫–∞—Ö (login/page.tsx)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
errorMessage = `–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: ${5 - attempts}`;
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø–æ–ø—ã—Ç–æ–∫
- –ü–æ–º–æ–≥–∞–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∞—Ç–∞–∫—É
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ email –≤ —Å–∏—Å—Ç–µ–º–µ

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π - –ø–æ–º–æ–≥–∞–µ—Ç –≤ –±—Ä—É—Ç—Ñ–æ—Ä—Å–µ

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
// –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
```

### 4. Email enumeration (register/page.tsx)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
const { error: signUpError } = await supabase.auth.signUp({
  email: formData.email,
  password: formData.password,
});
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –†–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö/–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö email
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ email
- –ü–æ–º–æ–≥–∞–µ—Ç –≤ —Å–±–æ—Ä–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π - —É—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞" (–¥–∞–∂–µ –µ—Å–ª–∏ email —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å email –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±–µ–∑ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### 5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç CSRF —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ö
- API endpoints –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç CSRF

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π - –≤–æ–∑–º–æ–∂–Ω—ã CSRF –∞—Ç–∞–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSRF —Ç–æ–∫–µ–Ω–∞
const csrfToken = crypto.randomBytes(32).toString('hex');
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Å–µ—Å—Å–∏–∏/–∫—É–∫–∞—Ö
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ middleware
```

### 6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ IP —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π API (login/page.tsx)

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
async function getClientIP(): Promise<string> {
  const response = await fetch('https://api.ipify.org?format=json');
  const data = await response.json();
  return data.ip;
}
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- –ú–µ–¥–ª–µ–Ω–Ω–æ (–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥)
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- IP –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∫—Å–∏/VPN

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π - –Ω–æ –ª—É—á—à–µ –ø–æ–ª—É—á–∞—Ç—å IP –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –í middleware.ts —É–∂–µ –µ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ IP –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
const ip = request.ip || 
  request.headers.get('x-forwarded-for')?.split(',')[0] ||
  request.headers.get('x-real-ip') ||
  'unknown';
```

## üü° –°—Ä–µ–¥–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏, –æ—Ç–ø—Ä–∞–≤–∏–≤ –∑–∞–ø—Ä–æ—Å –Ω–∞–ø—Ä—è–º—É—é –∫ API

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ API routes
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Zod/Pydantic –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 8. –°–ª–∞–±–∞—è –∑–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
if (formData.password.length < 8) {
  setError('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤');
}
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ª–∞–±—ã—Ö –ø–∞—Ä–æ–ª–µ–π (12345678, password –∏ —Ç.–¥.)

**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
function validatePassword(password: string): boolean {
  // –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
  if (password.length < 8) return false;
  // –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞
  if (!/[A-Z]/.test(password)) return false;
  // –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å—Ç—Ä–æ—á–Ω–∞—è –±—É–∫–≤–∞
  if (!/[a-z]/.test(password)) return false;
  // –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞
  if (!/[0-9]/.test(password)) return false;
  // –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª
  if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) return false;
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏
  const weakPasswords = ['password', '12345678', 'qwerty', 'admin'];
  if (weakPasswords.includes(password.toLowerCase())) return false;
  return true;
}
```

### 9. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –†–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö/–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö email
- –ü–æ–º–æ–≥–∞–µ—Ç –≤ email enumeration

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª–µ–π

### 10. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
await logLoginAttempt(email, 'failed', signInError.message);
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ï—Å–ª–∏ –ª–æ–≥–∏ —É—Ç–µ–∫—É—Ç, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π-–°—Ä–µ–¥–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏
- –ß–∞—Å—Ç–∏—á–Ω–æ —Å–∫—Ä—ã–≤–∞—Ç—å email (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º

## üü¢ –ù–∏–∑–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ / –£–ª—É—á—à–µ–Ω–∏—è

### 11. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CAPTCHA

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å reCAPTCHA v3 –¥–ª—è –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º

### 12. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç account enumeration

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ email

### 13. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç session fixation

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secure, httpOnly cookies

### 14. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç clickjacking

**–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ:**
- –ï—Å—Ç—å `X-Frame-Options: DENY` –≤ middleware
- –ù–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —Å CSP

### 15. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Content Security Policy

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```typescript
// –í middleware.ts
response.headers.set(
  'Content-Security-Policy',
  "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"
);
```

## üìã –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ):

1. ‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å rate limiting –≤ Redis
2. ‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å email enumeration

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ):

5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
7. ‚úÖ –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Ä–æ–ª–µ–π
8. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ IP

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

9. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å CAPTCHA
10. ‚úÖ –£–ª—É—á—à–∏—Ç—å –∑–∞—â–∏—Ç—É —Å–µ—Å—Å–∏–π
11. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å CSP
12. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç timing attacks

## üîß –ë—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

```typescript
// –í login/page.tsx
if (signInError) {
  // –í—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
  // –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
}
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –£–ª—É—á—à–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ IP

```typescript
// –£–±—Ä–∞—Ç—å getClientIP() –∏–∑ login/page.tsx
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP –∏–∑ middleware (–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∏)
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–æ–ª—è

```typescript
function validatePassword(password: string): { valid: boolean; error?: string } {
  if (password.length < 8) {
    return { valid: false, error: '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤' };
  }
  if (!/[A-Z]/.test(password)) {
    return { valid: false, error: '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã' };
  }
  if (!/[a-z]/.test(password)) {
    return { valid: false, error: '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã' };
  }
  if (!/[0-9]/.test(password)) {
    return { valid: false, error: '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã' };
  }
  if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
    return { valid: false, error: '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã' };
  }
  return { valid: true };
}
```

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö ‚úÖ

**–ë—ã–ª–æ:**
```typescript
errorMessage = `–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: ${5 - attempts}`;
```

**–°—Ç–∞–ª–æ:**
```typescript
errorMessage = '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å'; // –í—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω email enumeration ‚úÖ

**–ë—ã–ª–æ:**
```typescript
if (signUpError) {
  setError(signUpError.message); // –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ email
}
```

**–°—Ç–∞–ª–æ:**
```typescript
if (signUpError.message?.includes('already registered')) {
  // –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö, –¥–∞–∂–µ –µ—Å–ª–∏ email —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  setSuccess(true);
  return;
}
```

### 3. –£–ª—É—á—à–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π ‚úÖ

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–∑–∞–≥–ª–∞–≤–Ω—ã–µ, —Å—Ç—Ä–æ—á–Ω—ã–µ, —Ü–∏—Ñ—Ä—ã, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã
- –û—Ü–µ–Ω–∫–∞ —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è

### 4. –£–ª—É—á—à–µ–Ω rate limiting ‚úÖ

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –°–µ—Ä–≤–µ—Ä–Ω—ã–π endpoint `/api/auth/rate-limit`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á (IP + email)

### 5. –£–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ API ‚úÖ

**–ë—ã–ª–æ:**
```typescript
const response = await fetch('https://api.ipify.org?format=json');
```

**–°—Ç–∞–ª–æ:**
```typescript
// IP –ø–æ–ª—É—á–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
```

### 6. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection ‚úÖ

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∑–∞–ø—Ä–æ—Å–∞
- –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- SQLAlchemy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–∞–µ—Ç, –Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

---

**–ò—Ç–æ–≥:** 
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö/—Å—Ä–µ–¥–Ω–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- ‚ö†Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å rate limiting –≤ Redis –¥–ª—è production
- ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: –î–æ–±–∞–≤–∏—Ç—å CAPTCHA –∏ —É–ª—É—á—à–∏—Ç—å CSRF –∑–∞—â–∏—Ç—É

