# Gitleaks конфигурация для сканирования секретов
title = "OSS DVFU Secret Scanning"

[extend]
# Используем базовую конфигурацию
useDefault = true

[allowlist]
description = "Allowlist для известных безопасных паттернов"
paths = [
  '''\.gitignore''',
  '''\.github/.*\.md''',
  '''docs/.*\.md''',
  '''package\.json''',
  '''package-lock\.json''',
  '''\.example''',
  '''\.sample''',
  '''test/''',
  '''tests/''',
  '''__tests__/''',
  '''\.test\.''',
  '''\.spec\.''',
]

commits = [
  "example",
  "test",
  "placeholder",
  "TODO",
]

regexes = [
  '''process\.env\.[A-Z_]+''',
  '''NEXT_PUBLIC_[A-Z_]+''',
  '''\${{.*secrets\.[A-Z_]+}}''',
]

[[rules]]
id = "oss-dvfu-custom"
description = "Custom rules for OSS DVFU"
regex = '''(password|secret|key|token|api[_-]?key|private[_-]?key|access[_-]?token)\s*[:=]\s*['"][^'"]{8,}['"]'''
entropy = 3.5
tags = ["secret", "oss-dvfu"]

