-- ===============================
-- RLS Setup Instructions
-- ===============================
-- 
-- Этот файл содержит инструкции по настройке RLS политик
-- после создания таблицы user_roles и настройки Supabase Auth
--
-- ВАЖНО: Выполните эти шаги в правильном порядке:
--
-- 1. Создайте проект в Supabase
-- 2. Примените database/schema.sql (создаст таблицы и RLS политики)
-- 3. Включите Supabase Auth в настройках проекта
-- 4. Создайте пользователей через Supabase Auth UI или API
-- 5. Добавьте роли в таблицу user_roles:
--
--    INSERT INTO user_roles (user_id, role, direction_id)
--    VALUES 
--      ('<user-uuid>', 'board', NULL),  -- Руководство ОСС
--      ('<user-uuid>', 'lead', '<direction-uuid>'),  -- Руководитель направления
--      ('<user-uuid>', 'member', '<direction-uuid>');  -- Член ОСС
--
-- 6. Проверьте работу RLS политик:
--    - Публичные пользователи могут создавать обращения
--    - Публичные пользователи могут читать обращения только по public_token
--    - Члены ОСС видят только обращения своего направления
--    - Board и staff видят все обращения
--
-- 7. Для тестирования используйте Supabase SQL Editor:
--
--    -- Проверить текущего пользователя
--    SELECT auth.uid();
--
--    -- Проверить роли пользователя
--    SELECT * FROM user_roles WHERE user_id = auth.uid();
--
--    -- Проверить доступ к обращениям
--    SELECT * FROM appeals;  -- Должны видеть только доступные
--
-- ===============================

